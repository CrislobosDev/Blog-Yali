---
const navItems = [
  { href: "/", label: "Inicio" },
  { href: "/blog", label: "Blog" },
  { href: "/galeria", label: "Galería" },
  { href: "/contacto", label: "Contacto" },
];

const currentPath = Astro.url.pathname;
const isActive = (href) =>
  href === "/" ? currentPath === "/" : currentPath.startsWith(href);
---

<header class="site-header" data-menu="closed">
  <div class="container header-inner">
    <a class="brand" href="/" aria-label="Inicio">
      <img
        src="https://wkayvtztiijqpvoxtcxj.supabase.co/storage/v1/object/public/media/site/1769636652439-logo.webp"
        alt="Yali Salvaje"
        width="200"
        height="68"
      />
    </a>

    <nav class="nav-desktop" aria-label="Principal">
      {
        navItems.map((item) => (
          <a
            href={item.href}
            class={isActive(item.href) ? "is-active" : undefined}
            aria-current={isActive(item.href) ? "page" : undefined}
          >
            {item.label}
          </a>
        ))
      }
    </nav>

    <button
      class="menu-toggle"
      type="button"
      aria-expanded="false"
      aria-controls="menu-movil"
    >
      <span class="menu-text">Menú</span>
      <span class="menu-icon" aria-hidden="true"></span>
    </button>
  </div>

  <nav class="nav-mobile" id="menu-movil" aria-label="Menú móvil">
    {
      navItems.map((item) => (
        <a
          href={item.href}
          class={isActive(item.href) ? "is-active" : undefined}
          aria-current={isActive(item.href) ? "page" : undefined}
        >
          {item.label}
        </a>
      ))
    }
  </nav>
</header>

<style>
  .site-header {
    position: sticky;
    top: 0;
    z-index: 50;
    backdrop-filter: blur(18px);
    background: linear-gradient(
      135deg,
      rgba(12, 28, 18, 0.82),
      rgba(18, 38, 26, 0.68)
    );
    color: #ffffff;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  }

  .header-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    padding: 1rem 0;
  }

  .brand img {
    width: clamp(140px, 18vw, 220px);
    height: auto;
  }

  .nav-desktop {
    display: none;
    gap: 2rem;
    align-items: center;
    font-weight: 500;
  }

  .nav-desktop a,
  .nav-mobile a {
    text-decoration: none;
    color: inherit;
    position: relative;
  }

  .nav-desktop a::after,
  .nav-mobile a::after {
    content: none;
  }

  .nav-desktop a,
  .nav-mobile a {
    text-decoration: none;
    color: rgba(255, 255, 255, 0.85);
    padding: 0.5rem 1rem;
    border-radius: 999px;
    transition:
      background 0.2s ease,
      color 0.2s ease;
  }

  .nav-desktop a:hover,
  .nav-mobile a:hover,
  .nav-desktop a.is-active,
  .nav-mobile a.is-active {
    background: rgba(180, 220, 190, 0.12);
    color: #f7fff7;
  }

  .menu-toggle {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: inherit;
    padding: 0.6rem 1rem;
    border-radius: 999px;
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    cursor: pointer;
    transition:
      border-color 0.2s ease,
      background 0.2s ease,
      color 0.2s ease;
  }

  .menu-toggle:hover {
    border-color: rgba(180, 220, 190, 0.4);
    background: rgba(180, 220, 190, 0.08);
    color: #f7fff7;
  }

  .menu-icon {
    width: 20px;
    height: 2px;
    background: currentColor;
    display: block;
    position: relative;
  }

  .menu-icon::before,
  .menu-icon::after {
    content: "";
    position: absolute;
    left: 0;
    width: 20px;
    height: 2px;
    background: currentColor;
    transition: transform 0.3s ease;
  }

  .menu-icon::before {
    top: -6px;
  }

  .menu-icon::after {
    top: 6px;
  }

  .nav-mobile {
    display: grid;
    gap: 1rem;
    padding: 0 1.5rem 1.5rem;
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transform: translateY(-8px);
    transition:
      max-height 0.35s ease,
      opacity 0.25s ease,
      transform 0.35s ease;
  }

  .site-header[data-menu="open"] .nav-mobile {
    max-height: 320px;
    opacity: 1;
    transform: translateY(0);
  }

  .site-header[data-menu="open"] .menu-icon {
    background: transparent;
  }

  .site-header[data-menu="open"] .menu-icon::before {
    transform: translateY(6px) rotate(45deg);
  }

  .site-header[data-menu="open"] .menu-icon::after {
    transform: translateY(-6px) rotate(-45deg);
  }

  @media (min-width: 840px) {
    .nav-desktop {
      display: flex;
    }

    .menu-toggle,
    .nav-mobile {
      display: none;
    }
  }

  @media (max-width: 839px) {
    .site-header {
      max-height: 96px;
      overflow: hidden;
      transition: max-height 0.35s ease;
    }

    .site-header[data-menu="open"] {
      max-height: 420px;
    }
  }
</style>

<script>
  const header = document.querySelector(".site-header");
  const toggle = header?.querySelector(".menu-toggle");
  const mobileNav = header?.querySelector(".nav-mobile");
  if (toggle && mobileNav && header) {
    toggle.addEventListener("click", () => {
      const isOpen = header.getAttribute("data-menu") === "open";
      header.setAttribute("data-menu", isOpen ? "closed" : "open");
      toggle.setAttribute("aria-expanded", String(!isOpen));
    });
  }
</script>
