---
// src/pages/galeria.astro

// CORRECCI√ìN: La ruta correcta a tu Layout.astro es '../layout/Layout.astro' (min√∫sculas).
import Layout from "../layout/Layout.astro"; 

// Estos ya estaban correctos (asumiendo que los usas en el Layout y Header/Footer)
import Header from "../components/Header.astro";
import Footer from '../components/Footer.astro';

// La ruta a tu cliente de Supabase es correcta:
import { supabase } from '../lib/supabaseClient'; 


// 2. Consultar la tabla de im√°genes
// ¬°Aseg√∫rate de que el nombre de tu tabla sea exactamente 'imagenes' o 'galeria_fotos'!
const { data: fotos, error } = await supabase
  .from('imagenes') 
  .select('id, url_publica, alt_text, descripcion') 
  .order('created_at', { ascending: false }); 

  console.log("Error de Supabase:", error);
  console.log("Datos recibidos:", fotos); 

if (error) {
  // Es buena pr√°ctica lanzar un error visible en desarrollo
  console.error("Error al cargar la galer√≠a:", error);
  // Opcionalmente, puedes mostrar este mensaje de error en el HTML tambi√©n.
}

const imagenesGaleria = fotos || []; 
---
<Layout title="Galer√≠a Fotogr√°fica | Yali Salvaje">
  <main class="container">
    <h1>Galer√≠a del Humedal El Yali üì∏</h1>
    <p>Una colecci√≥n de la flora y fauna de la 5ta Regi√≥n de Chile.</p>
    
    <div class="grid-galeria">
      {imagenesGaleria.length === 0 ? (
        <p>A√∫n no hay fotos en la galer√≠a.</p>
      ) : (
        imagenesGaleria.map((foto) => (
          <figure class="foto-item">
            <img 
              src={foto.url_publica} 
              alt={foto.alt_text} 
              loading="lazy"
              width="500" 
              height="350"
            />
            {foto.descripcion && <figcaption>{foto.descripcion}</figcaption>}
          </figure>
        ))
      )}
    </div>
  </main>
  
  </Layout>

<style>
  /* ... (Tus estilos CSS) ... */
</style>